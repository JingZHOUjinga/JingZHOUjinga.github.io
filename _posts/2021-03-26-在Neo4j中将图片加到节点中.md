---
layout:     post
title:      技巧|在Neo4j中将图片加到节点中
subtitle:   如何为节点指定图片并加以显示
date:       2021-03-26
author:     Jinga
header-img: img/grey.jpg
catalog: true
tags:
    - 图数据库
---

# 在Neo4j中将图片加到节点中

* [1.问题背景](#1)
* [2.java环境配置](#2)
* [3.安装Neo4j中文版](#3)

<h2 id="1">1.问题背景</h2>

这个需求是由Eve同学提出来的，问我能不能在Neo4j中嵌入图片。我试了下用本地图片去创建节点，可是失败了，然后就在[neo4j中文版导入图片的路径问题](http://neo4j.com.cn/topic/5fce40b4d4a2c82263722372)看到图片不能用文件路径

于是就通过[图床](https://imgurl.org/)将本地图片转化为url的图片路径　　

再创建节点导入图片发现图片url地址是可以存在数据库中但是查看不给你显示图片出来，这就有些尴尬了不美观　　

尝试在Neo4j基础上找到可视化工具进行渲染，比如有[neo4jd3](https://github.com/eisman/neo4jd3),[效果](https://github.com/eisman/neo4jd3)挺动态酷炫的；找到[图数据可视化分析组件的总结](https://www.pianshen.com/article/55881250887/),不过这些有很多是需要收费的

继续找方案，在[这里](http://neo4j.com.cn/topic/5ad45b4451bad0a10b198bfa)看到说使用微云数据库的中文版本可以实现，我一想有可能是我Neo4j版本不对的缘故，我这个是用的原生英文版的，所以接下来试下用Neo4j中文版行不行得通

装好中文版后启动，却提示说jdk版本过低，只好重新弄java环境了

<h2 id="2">2.java环境配置</h2>  

**卸载旧版java**

```

$ sudo apt-get autoremove default-jdk

``` 

发现没有卸载干净，于是采用下面的方法彻底删除

```
$ sudo apt-get update
$ sudo apt-cache search java | awk '{print($1)}' | grep -E -e '^(ia32-)?(sun|Oracle)-java' -e '^openjdk-' -e '^icedtea' -e '^(default|gcj)-j(re|dk)' -e '^gcj-(.*)-j(re|dk)' -e 'java-common' | xargs sudo apt-get -y remove
$ sudo apt-get -y autoremove
$ dpkg -l | grep ^rc | awk '{print($2)}' | xargs sudo apt-get -y purge
$ bash -c 'ls -d /home/*/.java' | xargs sudo rm -rf 
$ rm -rf /usr/lib/jvm/*
``` 

然后通过java -version测试现在是找不到java了

**安装jdk-11**　　

通过官网下载实在太慢了，就[借助阿里云快速下载 Oracle JDK](https://www.v2ex.com/t/665632)

下完jdk-11.0.7_linux-x64_bin.tar.gz后，解压

```

$ tar -zxf jdk-11.0.7_linux-x64_bin.tar.gz jdk-11.0.7/

``` 

配置jdk环境变量，打开/etc/profile文件，复制下面配置信息　　

```
# set openjdk environment
export JAVA_HOME=~/jdk-11.0.7
export PATH=$JAVA_HOME/bin:$PATH
``` 

命令行输入java -version后没有找到java，再按照以下命令安装

```

$ sudo apt install openjdk-11-jre-headless

``` 

现在再输入java -version就有了openjdk版本信息了

<h2 id="3">3.安装Neo4j中文版</h2>

通过[这里](http://doc.we-yun.com:1008/neo4j-chs/4.2.4/)下载neo4j-chs-community-4.2.4-unix.tar.gz　　

解压　

```

$ tar -xf tar -xf neo4j-chs-community-4.2.4-unix.tar.gz

``` 　

在neo4j-chs-community-4.2.4-unix文件夹下启动　　

```

$ ./bin/neo4j console

``` 　  


通过浏览器访问http://localhost:7474/，填写用户名密码进行身份验证　　

现在就登录到Neo4j中文版本了，版权归微云数聚

![neo4jchinese.png](/img/20210326neo4jchinese.png)  

这时再尝试将图片加入节点

```

CREATE(Blender:model{name:"Blender",image:"https://ftp.bmp.ovh/imgs/2021/03/053671647de344c2.png"}),(Meena:model{name:"Meena",image:"https://ftp.bmp.ovh/imgs/2021/03/aff7906093fc5419.png"}),(DialogGPT:model{name:"DialogGPT",image:"https://ftp.bmp.ovh/imgs/2021/03/f6af004a50e0c7e7.png"}),(PLATO:model{name:"PLATO",image:"https://ftp.bmp.ovh/imgs/2021/03/0fb955b836e89dcc.png"}),(谷歌:company{name:"谷歌",image:"https://ftp.bmp.ovh/imgs/2021/03/4c2a0f0bcb9720f8.png"}),(脸书:company{name:"脸书",image:"https://ftp.bmp.ovh/imgs/2021/03/19141cf055bff7f3.png"}),(微软:company{name:"微软",image:"https://ftp.bmp.ovh/imgs/2021/03/b5d94b6e6f002a7e.png"}),(百度:company{name:"百度",image:"https://ftp.bmp.ovh/imgs/2021/03/38d4d2226af3f8cc.png"}),(英语:语言{name:"英语",image:"https://ftp.bmp.ovh/imgs/2021/03/c0dca8b58a4f9e3e.png"}),(脸书)-[:开发]->(Blender),(谷歌)-[:开发]->(Meena),(微软)-[:开发]->(DialogGPT),(百度)-[:开发]->(PLATO),(Blender)-[:语料]->(英语),(Meena)-[:语料]->(英语),(DialogGPT)-[:语料]->(英语)

``` 　  


查看结果

![neo4jgraph.png](/img/20210326neo4jgraph.png)

到此大功告成了!

在解决问题的过程中也发现了一些宝藏，比如[d3.js可视化neo4j图数据库项目](https://blog.csdn.net/qq_34414916/article/details/81168275?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&dist_request_id=&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control),[综述阅读--多模态数据库](https://zhuanlan.zhihu.com/p/248485434),收藏留待之后有时间研读学习

##### 参考:

1. [Ubuntu下彻底删除java](https://blog.csdn.net/plaugle/article/details/88358828)
2. [虚拟机linux安装jdk11.0.7（使用压缩包）](https://blog.csdn.net/m0_46581270/article/details/106554316)
3. [Neo4j 4.0 简体中文版](http://doc.we-yun.com:1008/neo4j-chs-doc/neo4j-4.0-chs-guide.pdf)

